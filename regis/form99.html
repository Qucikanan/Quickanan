<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- JavaScript Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
      crossorigin="anonymous"
    ></script>
    <script src="https://kit.fontawesome.com/ad42651166.js" crossorigin="anonymous"></script>
    <!-- CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
    <title>ฟอร์มลงทะเบียน</title>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
      integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
      crossorigin="anonymous"
    ></script>
    <script
      charset="utf-8"
      src="https://static.line-scdn.net/liff/edge/2/sdk.js"
    ></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Kanit"
    />
    <style>
      body {
        font-family: "Kanit", sans-serif;
      }
    </style>
  </head>

  <body>
    <nav class="navbar navbar-expand-sm bg-warning navbar-dark">
      <!-- Brand -->
      <a class="navbar-brand" href="#">&nbsp&nbsp Tingly Army Club </a>

      <!-- Toggler/collapsibe Button -->
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#collapsibleNavbar"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Navbar links -->
      <div class="collapse navbar-collapse" id="collapsibleNavbar">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a
              class="nav-link"
              href="https://timeline.line.me/post/_dQFUVM9_DYZHIB43bQBeyTR2hM56T_9_vFm61Ag/1162089377903076126"
              >&nbsp&nbsp&nbsp&nbspรายละเอียดงาน
              <br />&nbsp&nbsp&nbsp&nbspNAVAMINDRACHINEE QUEEN'S CUP 2021</a
            >
          </li>
        </ul>
      </div>
    </nav>

    <div class="container register">
      <div class="continer-fluid">
        <div class="col justify-content-center">
          <div class="col text-center">
            <h1 class="text-primary fw-bold"></h1>
            <h3 class="text-muted fw-bold">ฟอร์มลงทะเบียน</h3>
            <h6 class="text-muted fw-bold">
              NAVAMINDRACHINEE QUEEN'S CUP 2021
            </h6>
          </div>
        </div>
        <form
          method="post"
          autocomplete="off"
          id="google-sheet"
          name="google-sheet"
        >
          <div class="col justify-content-center mt-2">
            <div class="col-md-3 mt-3">
              <label for="name" class="form-label">Name</label>
              <input
                type="text"
                class="form-control"
                name="Name"
                id="name"
                placeholder="ระบุชื่อ-นามสกุล ภาษาอังกฤษ"
                required
              />
            </div>
            <div class="col-md-3 mt-3">
              <label for="position" class="form-label">IDPA Member</label>
              <input
                type="text"
                class="form-control"
                name="Member"
                id="member"
                placeholder="ระบุหมายเลข IDPA สากล หรือ XXX"
                required
              />
            </div>

            <div class="col-md-3 mt-3">
              <label for="sel1">Division</label>
              <select
                class="form-select"
                aria-label="Default select example"
                name="Division"
                id="division"
                required
              >
                <option selected></option>
                <option>ESP</option>
                <option>SSP</option>
                <option>CDP</option>
                <option>CCP</option>
                <option>REV</option>
                <option>BUG</option>
                <option>PCC</option>
                <option>CO</option>
                <option>SPD</option>
              </select>
            </div>
            <div class="col-md-3 mt-3">
              <label for="sel1">Class</label>
              <select
                class="form-select"
                aria-label="Default select example"
                name="Klass"
                id="klass"
                required
              >
                <option selected></option>
                <option>MA</option>
                <option>EX</option>
                <option>SS</option>
                <option>MM</option>
                <option>NV</option>
                <option>UN</option>
              </select>
            </div>

            <div class="col-md-3 mt-3">
              <label for="sel1">Catagories</label>

              <div class="checkbox">
                <input
                  type="checkbox"
                  class="check"
                  name="blank"
                  id="blank"
                  value="-"
                  checked
                />
                <label for="checkbox"> ไม่ระบุ </label>
              </div>
              <div class="checkbox">
                <label
                  ><input
                    type="checkbox"
                    class="check"
                    name="Junior"
                    id="Junior"
                    value="Junior"
                  />&nbsp Junior</label
                >
              </div>
              <div class="checkbox">
                <label
                  ><input
                    type="checkbox"
                    class="check"
                    name="Senior"
                    id="Senior"
                    value="Senior"
                  />&nbsp Senior</label
                >
              </div>
              <div class="checkbox">
                <label
                  ><input
                    type="checkbox"
                    class="check"
                    name="Lady"
                    id="Lady"
                    value="Lady"
                  />&nbsp Lady</label
                >
              </div>
              <div class="checkbox">
                <label
                  ><input
                    type="checkbox"
                    class="check"
                    name="LawEnforcement"
                    id="LawEnforcement"
                    value="LawEnforcement"
                  />&nbsp Law Enforcement</label
                >
              </div>
              <div class="checkbox">
                <label
                  ><input
                    type="checkbox"
                    class="check"
                    name="StateEnterprise"
                    id="StateEnterprise"
                    value="StateEnterprise"
                  />&nbsp State Enterprise</label
                >
              </div>
              <div class="checkbox">
                <label
                  ><input
                    type="checkbox"
                    class="check"
                    name="International"
                    id="International"
                    value="International"
                  />&nbsp International</label
                >
              </div>
            </div>

            <div class="col-md-3 mt-3">
              <label for="sel1">Squad</label>
              <select
                class="form-select"
                aria-label="Default select example"
                name="SQ"
                id="sq"
                required
              >
                <option selected></option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
                <option>6</option>
                <option>7</option>
                <option>8</option>
                <option>9</option>
                <option>10</option>
                 <option>11</option>
                <option>12</option>
                <option>13</option>
                <option>14</option>
                <option>15</option>
                <option>16 Staff/So</option>
              </select>
            </div>
          </div>
          <div class="justify-content-center">
            <div class="text-center">
             <p class="text-muted fw-bold">
          ชำระเงินได้ที่ : ธนาคารทหารไทย <br />
          ชื่อบัญชี การแข่งขันยิงปืนนวมิทราชินี <br />
          เลขที่บัญชี 301-2-87590-6 <br />
              <button
                type="button"
                onclick="myFunction()"
                class="btn btn-light btn-sm"
              >
               <i class="far fa-copy"></i> Copy เลขที่บัญชี 
              </button>
            </p>
          </div>
</div>
          <div class="col justify-content-center">
            <div class="col-md-3 mt-4 text-center">
              <button
                class="btn btn-outline-warning btn-lg"
                type="submit"
                name="submit"
                id="submit"
              >
                Submit
              </button>
            </div>
          </div>
          <input
            type="text"
            value="3012875906"
            id="myInput"
            style="border: none;color:white;"
          />
          <div class="row justify-content-center mt-2">
            <div class="row">
              <label for="name" class="form-label"></label>
              <input
                type="hidden"
                class="form-control input-sm "
                name="Uid"
                id="uid"
                placeholder="Userid"
                required
              />
            </div>
            <div class="row">
              <label for="name" class="form-label"></label>
              <input
                type="hidden"
                class="form-control"
                name="UName"
                id="uname"
                placeholder="UName"
                required
              />
            </div>
            <div class="row">
              <label for="name" class="form-label"></label>
              <input
                type="hidden"
                class="form-control"
                name="Upic"
                id="upic"
                placeholder="Upicture"
                required
              />
            </div>
          </div>
        </form>
      </div>
    </div>

    <script>
      function myFunction() {
        var copyText = document.getElementById("myInput");
        copyText.select();
        document.execCommand("copy");
        swal("คัดลอกเลขที่บัญชีเรียบร้อย!");
      }

      window.onload = function() {
        initializeLiff("1655710211-rXXd0P4v");
      };

      function initializeLiff(myLiffId) {
        liff
          .init({
            liffId: myLiffId
          })
          .then(() => {
            getid();
          })
          .then(() => {
            testclick();
          })
          .catch(err => {});
      }

      function getid() {
        liff.getProfile().then(function(profile) {
          const uid = profile.userId;
          const uname = profile.displayName;
          const upic = profile.pictureUrl;
          document.getElementsByName("Uid")[0].value = uid;
          document.getElementsByName("UName")[0].value = uname;
          document.getElementsByName("Upic")[0].value = upic;
        });
      }

      function testclick() {
        //button1

        document.getElementById("submit").addEventListener("click", function() {
          var x = document.getElementById("name");
          var y = document.getElementById("member");
          var z = document.getElementById("division");
          var a = document.getElementById("klass");
          var b = document.getElementById("sq");
          var c = document.getElementById("upic");
          var checkbox = [].map
            .call(
              document.querySelectorAll('[type="checkbox"]:checked'),
              function(v) {
                return v.value;
              }
            )
            .join(" , ");

          liff
            .sendMessages([
              {
                type: "flex",
                altText: "This is a Flex Message",
                contents: {
                  type: "bubble",
                  header: {
                    type: "box",
                    layout: "vertical",
                    contents: [
                      {
                        type: "box",
                        layout: "vertical",
                        contents: [
                          {
                            type: "text",
                            text: "ลงทะเบียนสำเร็จ!!!",
                            size: "xxl",
                            weight: "bold",
                            align: "center"
                          }
                        ]
                      },
                      {
                        type: "box",
                        layout: "vertical",
                        contents: [
                          {
                            type: "image",
                            url: c.value,
                            margin: "none",
                            size: "lg",
                            aspectMode: "cover"
                          }
                        ],
                        cornerRadius: "100px",
                        position: "absolute",
                        offsetStart: "35%",
                        offsetTop: "38%"
                      }
                    ],
                    height: "200px"
                  },
                  body: {
                    type: "box",
                    layout: "vertical",
                    contents: [
                      {
                        type: "box",
                        layout: "vertical",
                        margin: "none",
                        spacing: "sm",
                        contents: [
                          {
                            type: "box",
                            layout: "baseline",
                            spacing: "sm",
                            contents: [
                              {
                                type: "text",
                                text: "IDPA Member",
                                color: "#aaaaaa",
                                size: "sm",
                                flex: 3,
                                wrap: true
                              },
                              {
                                type: "text",
                                text: "" + y.value,
                                wrap: true,
                                color: "#666666",
                                size: "md",
                                flex: 5,
                                position: "relative"
                              }
                            ]
                          },
                          {
                            type: "box",
                            layout: "baseline",
                            spacing: "sm",
                            contents: [
                              {
                                type: "text",
                                text: "Name :",
                                color: "#aaaaaa",
                                size: "sm",
                                flex: 3
                              },
                              {
                                type: "text",
                                text: "" + x.value,
                                wrap: true,
                                color: "#666666",
                                size: "md",
                                flex: 5
                              }
                            ]
                          },
                          {
                            type: "box",
                            layout: "baseline",
                            spacing: "sm",
                            contents: [
                              {
                                type: "text",
                                text: "Division :",
                                color: "#aaaaaa",
                                size: "sm",
                                flex: 3
                              },
                              {
                                type: "text",
                                text: "" + z.value,
                                wrap: true,
                                color: "#666666",
                                size: "md",
                                flex: 5
                              }
                            ]
                          },
                          {
                            type: "box",
                            layout: "baseline",
                            spacing: "sm",
                            contents: [
                              {
                                type: "text",
                                text: "Class :",
                                color: "#aaaaaa",
                                size: "sm",
                                flex: 3
                              },
                              {
                                type: "text",
                                text: "" + a.value,
                                wrap: true,
                                color: "#666666",
                                size: "md",
                                flex: 5
                              }
                            ]
                          },
                          {
                            type: "box",
                            layout: "baseline",
                            spacing: "sm",
                            contents: [
                              {
                                type: "text",
                                text: "Catagories :",
                                color: "#aaaaaa",
                                size: "sm",
                                flex: 3
                              },
                              {
                                type: "text",
                                text: "" + checkbox,
                                wrap: true,
                                color: "#666666",
                                size: "md",
                                flex: 5
                              }
                            ]
                          },
                          {
                            type: "box",
                            layout: "baseline",
                            spacing: "sm",
                            contents: [
                              {
                                type: "text",
                                text: "Squad :",
                                color: "#aaaaaa",
                                size: "sm",
                                flex: 3
                              },
                              {
                                type: "text",
                                text: "" + b.value,
                                wrap: true,
                                color: "#666666",
                                size: "md",
                                flex: 5
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  footer: {
                    type: "box",
                    layout: "vertical",
                    spacing: "sm",
                    contents: [
                      {
                        type: "button",
                        style: "primary",
                        height: "sm",
                        action: {
                          type: "uri",
                          label: "ส่งสลิป",
                          uri: "https://liff.line.me/1655586880-ReVYMAjb"
                        }
                      },
                      {
                        type: "spacer",
                        size: "sm"
                      }
                    ]
                  },
                  styles: {
                    header: {
                      backgroundColor: "#FFFFFF"
                    }
                  }
                }
              }
            ])

            .then(function() {
              liff.closeWindow();
            });
        });
      }

      const scriptURL =
        "https://script.google.com/macros/s/AKfycbzHAlzRrBQ6uesRQPWVUeZw2ni3GrsVm_8vVb-tcxhFEN9IyVk/exec";
      const form = document.forms["google-sheet"];

      form.addEventListener("submit", e => {
        e.preventDefault();
        fetch(scriptURL, { method: "POST", body: new FormData(form) })
          .then(response => document.getElementById("google-sheet").reset())

          .catch(error => console.error("Error!", error.message));
      });
    </script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  </body>
</html>
